# NPT Equilibrium
log             log/log.equilibrium.lammps

# Initialization
kim             init    LJ_ElliottAkerson_2015_Universal__MO_959249795837_003 real
dimension       3
boundary        p p p
atom_style      full

# Variables
variable    Liquid_Z_low    equal  6.45     # start of the liquid region.
variable    Liquid_Z_high   equal  25.0     # end of the liquid region.
variable    T               equal  298.15   # Room tempreture.
variable    P               equal  1.0      # Pressure.

# System Definition
read_data       system/system.data

kim             interactions    C Ca Cl H N Na O Ti
neigh_modify    one             10000

# Define Groups
group       C       type    1   
group       H       type    4   
group       N       type    5   
group       O       type    7   
group       H2O     type    7   4
group       Ti      type    8   

region      piston  block   INF INF     INF INF     ${Liquid_Z_high} INF
region      liquid  block   INF INF     INF INF     ${Liquid_Z_low}  ${Liquid_Z_high}
region      bottom  block   INF INF     INF INF     INF              ${Liquid_Z_low}

group       bottom  region  bottom
group       piston  region  piston
group       liquid  region  liquid

# Settings
velocity    all         create  $T 49284    rot yes dist gaussian
fix         MEMBRANE    bottom  setforce    0.0 0.0 0.0
fix         PISTON      piston  setforce    0.0 0.0 0.0

thermo          100
thermo_style    multi

# Visualization
dump            1   all     xyz 50 visual/equilibrium.xyz
dump_modify     1   element C Ca Cl HW N Na OW Ti

# NPT Equilibrium
fix             NPT     all npt temp $T $T 100.0  iso $P $P 1000.0
minimize        1.0e-8 1.0-e-10 10000 100000
unfix           NPT

# NVT Equilibrium
fix             NVT     all nvt temp $T $T 100.0
minimize        1.0e-8 1.0-e-10 10000 100000
unfix           NVT

# NVE Equilibrium
fix             NVE     all nve
minimize        1.0e-6 1.0-e-8 10000 100000
unfix           NVE

# Finalization
write_data      system/equilibrium.system.data
# write_restart   system/NPT.system.rest
